﻿**Tomcat连接器：**##应用程序架构：- 主要类：>Bootstrap:启动模块>>HttpConnector类>>>HttpProcessor类>>>>HttpRequest对象  >>>>HttpResponse对象  >>>>StaticResourceProcessor类（静态资源获取）  >>>>ServletProcessor类（动态资源获取） - 辅助类：>Requestream类，ResponseStream类  >ResponseWriter类        >Constants类：final类，指明WEB_ROOT工作目录   >HttpHeader类  >HttpRequestLine类   >两个包装类HttpRequestFacade,HttpResponseFacade.     #### 主要类的实现：- Bootstrap：创建连接器对象，启动连接器。- HttpConnector类：实现了Runnable接口，等待HTTP请求，创建服务器套接字，为每一个请求创建一个HttpProcessor对象进行处理.- HttpProcessor类：  > HttpProcessor(HttpConnector connector):设置关联连接器      > process(Socket socket):根据获得的请求判断请求的是静态还是动态资源，然后获取资源。  >paresHeaders(SocketInputStream input)和parseRequest(SocketInputStream input,OutputStream output)：两个方法辅助process方法进行request的解析。   ####启动过程：  boostrap创建连接器对象（connector）---->connector启动进行循环监听HTTP请求，收到请求---->为每一个请求创建独立的HttpProcessor对象（processor）----->processor创HttpRequest对象和HttpResponse并进行填充，之后进行请求的解析，区分是请求静态资源还是动态资源。 - 若为静态资源：创建StaticResourceProcessor对象调用其process方法，在process方法中需要一个HttpResponse对象参数，此处直接使用response封装好的sendStaticResource()方法。   - 若为动态资源：则创建ServletProcessor对象，其对象中加载动态资源的方法使用了类加载器进行实现。--------------------------------------------------------------------------------------------------------#Tomcat默认连接器- Tomcat中的连接器实现了：实现org.apache.catalina.Connector接口，创建Request,Response对象。调用Container接口的方法invoke（Request，Response）把两个对象传递给servlet容器。- Connector接口重要方法：>setContainer():连接器和某个servlet容器关联  >getContainer();  >createRequest():创建request对象  >createResponse():创建response对象- HttpConnector类：实现了Connector接口，Runnable接口（启动时需要调用start（）方法），Lifecycle接口（启动时需要调用initialize（）方法）。一个 HttpConnector实例维护一个HttpProcessor实例池。##应用程序架构：>Bootstrap:启动程序  >SimpleContainer:servlet容器- Boostrap：首先创建一个HttpConnector对象，创建一个servlet容器SimpleContainer，为连接器添加容器，在调用时连接器对象会把request和response对象通过容器的invoke方法进行传递，此处就是HttpConnector对象通过使用SimpleContainer的实例的public void invoke(Request request, Response response)方法进行传递（此处理解可能有误）。最后因为SimpleContainer实现了Lifecycle接口和Runnable接口，所以分别调用initialize()和start（）方法进行启动。   